% TODO refactor dots stuff

\section{Main Contribution}\label{sec:algorithm}
Let $G = (V, E)$ be a $k$-graph with $n$ vertices and $m$ edges.
We describe a polynomial-time algorithm that finds a complete $k$-partite $k$-graph in $G$
with all part sizes at least
\begin{equation}
     t = t (n, d, k) = \left\lfloor \left(  \frac{\log (n/2^{k-1})}{\log (3/d)} \right)^{\frac{1}{k-1}} \right\rfloor \label{eq:t},
\end{equation}
where
\begin{equation} \label{eq:d}
    d = m/n^k
\end{equation}
is the ``un-normalized'' density of $G$,
which is easier to work with for the arguments that follow.
For the remainder of the section, we assume that
$t \geq 2$ (otherwise, we may just select a set of $k$ vertices forming an edge in~$G$).
More precisely, we show the following.
\begin{theorem}\label{thm:kpartite}
    There is an algorithm that, given a $k$-graph $G$ satisfying the conditions above,
    finds a $\compoverset{k}{t}$ embedded in $G$ with $t = t(n, d, k)$.

    That is, the algorithm returns a tuple of sets ${(V_1, \dots, V_k) \subset \binom{V}{t}^k}$ such that
    $V_1 \times \dots \times V_k \subset E$.
    Furthermore, the algorithm's runtime is polynomial in $n$.
\end{theorem}

\begin{remark}
    The stated condition implies that the sets $V_1, \dots, V_k$ are disjoint:
    If, for example, $v \in V_1 \cap V_2$ and for $3 \leq i \leq k$ $v_i \in V_i$ then
    $(v, v, v_3, \dots, v_k) \in V_1 \times \dots \times V_k$ has size $k-1$ as an unordered set so it cannot
    be an edge in $G$.
    This means that the inclusion map from $\compdots{V_1}{V_k}$ to $V$ defines an embedding, as desired.
\end{remark}

This gives a constructive proof of Theorem~\ref{thm:erdos64}.
Indeed, suppose we have a fixed value for $t$.
For $n$ large enough, we may choose $d$ such that $t(n, d, k) \geq t$.
By our definition of $t$, we only need that
\[
    d \geq 3 {\left( \frac{2^{k-1}}{n}\right)}^{\frac{1}{t^{k-1}}},
\]
which is satisfied for
\[
    m =
    \left\lceil
    3 n^k {\left( \frac{2^{k-1}}{n}\right)}^{\frac{1}{t^{k-1}}}
    \right\rceil =
    \bigO{n^{k - \frac{1}{t^{k-1}}}}.
\]
The construction in Theorem~\ref{thm:kpartite} then proves
\[
    \ex{n}{\compoverset{k}{t}} < m = \bigO{n^{k - \frac{1}{t^{k-1}}}}.
\]
Furthermore, for a fixed value of $d$,
the value of $t$ is in the best possible order of magnitude.
Indeed, if
\[
    dn^k \geq \ex{n}{\compoverset{k}{t}},
\]
by Poposition~\ref{prop:probabilistic-lower-bound}, we have that
\[
    d \geq n^{-\frac{k(t-1)}{t^{k}-1}}.
\]
Thaking logarithms and rearranging, we get
\[
    \log{(1/d)} \leq \frac{k(t-1)}{t^{k}-1} \log n \leq \frac{2k}{t^{(k-1)}} \log n,
\]
which implies
\[
    t \leq \left( \frac{2k \log n}{\log(1/d)} \right)^{\frac{1}{k-1}} =
    \bigO{\left\lfloor \left(  \frac{\log (n/2^{k-1})}{\log (3/d)} \right)^{\frac{1}{k-1}} \right\rfloor}.
\]

\subsection{Previous Results}\label{subsec:previous-results}

For $k = 2$, this problem was already solved by an algorithm of Mubayi and Turán~\cite{MUBAYI2010174},
which we present here (Algorithm~\ref{alg:bipartite}) for context and clarity.
A slightly different value for $t$ is used because of different estimates in their proof of correctness.
Specifically, $t$ is set to
\[
    t_2(n, d) = \left\lfloor \frac{\log (n/2) }{\log (2e/d)}\right\rfloor,
\]
whereas we get
\[
    t(n, d, 2) = \left\lfloor
        \left(  \frac{\log (n/2)}{\log (3/d)} \right)
       \right\rfloor.
\]
The vertex set $V(G)$ is partitioned into two sets $U$ and $W$ such that there are many edges between them
and the size of $W$ is logarithmic in $n$.
This is achieved by selecting $W$ to be a set of vertices of highest degree
(that is, no vertex in $U$ has a higher degree than any vertex in $W$).
Then, by iterating over all $t$-subsets of $W$, such a set $T$
is found satisfying that the set $S$ of common neighbors of $T$ in $U$ has size at least $t$.
In other words, $S \times T \subset E$ for $S, T \subset V$ of size at least $t$.

\begin{algorithm}[H]
    \caption{Finding a balanced bipartite graph in a $2$-graph}
    \label{alg:bipartite}
        \begin{algorithmic}[1]
        \Require A graph G = $(V, E)$ with $|V| = n$, $E = m$
        \State $d \gets m / n^2 $
        \State \textbf{assert} $d \geq 3 n^{-1/2}$ \label{line:bipartite_min_d}

        \State $t \gets \left\lfloor\frac{\log (n/2) }
        {\log (2e/d)}\right\rfloor,\, w \gets \lfloor t/d \rfloor$

        \State $W \gets $ a set of $w$ vertices with highest degree in $G$
        \State $U \gets V \setminus W$
        \ForAll{$T \in \binom{W}{t} $} \label{line:2partite_for}
            \State $S \gets \{x \in U \colon \{x, y\} \in E \text{ for all } y \in T\}$
            \If{$|S| \geq t$}
                \State \Return $(S, T)$
            \EndIf
        \EndFor
        \end{algorithmic}
\end{algorithm}

The minimum density $d \geq 3n^{-1/2}$ in line~\ref{line:bipartite_min_d} is required
because if $d = o\left(n^{-1/2}\right)$ then
there may not even be a $K(2, 2)$ in $G$.
If the set $S$ is too large, a subset of it of size $t$ can be returned instead.
To see that the algorithm returns a pair of sets $(S, T)$, one uses the fact that
there is large number of edges between $U$ and $W$ (proportional to the size of $W$).
Then, a direct application of Theorem~\ref{thm:kst}
with $u = |U| = n - w$ and $s = t$ shows that
there is a $K(t, t)$ in the bipartite graph $(U, W; E \cap (U \times W))$.
This in turn means that for some $T$,
the size of $S$ is at least $t$
and the algorithm returns $(S, T)$.
Finally, the algorithm runs in polynomial time because 
the  number of iterations of the loop is
\[
    \binom{w}{t} \leq
    \left(\frac{ew}{t}\right)^t \leq
    \left(\frac{1}{d}\right)^t e^t < e^{t \log (1/d) + \log n} <
    e^{2\log n} = n^2.
\]

\subsection{General Algorithm for Hypergraphs} \label{subsec:algorithm-for-k-graphs}

We now present Algorithm~\ref{alg:kpartite}, which is
a generalization of Algorithm~\ref{alg:bipartite} to $k$-graphs.
It follows the same structure as Algorithm~\ref{alg:bipartite},
but it is defined recursively, resembling the induction step of Theorem~\ref{thm:erdos64}.
This is the algorithm mentioned in Theorem~\ref{thm:kpartite},
and the main contribution of this work.

The main idea is to select a set $W \subset V$ of vertices of highest degree with
\begin{equation}
    \label{eq:w}
    |W| = w = w(n, d, k) = \left\lceil \frac{2t(n, d, k)}{d} \right\rceil.
\end{equation}

Then, for every $t$-subset $T$ of $W$, we compute the set $S$ of $(k-1)$-subsets of $V \setminus W$
that form an edge with every vertex in $T$.
These are precisely the edges of $G' = L_{k-1}(G; T) = (V \setminus W, S)$.
For a specific $T$, the set $S$ satisfies

\begin{equation}
    \label{eq:s}
    |S| \geq s = s(n, d, k) = \left\lceil d^{t(n, d, k)} n^{k-1} \right\rceil.
\end{equation}

As it turns out, $S$ is large enough~\eqref{eq:s}
that applying the algorithm recursively to $G'$
yields a $\compoverset{k-1}{t'}$ in $G'$ with $t' \geq t$.
That is, a tuple
$P' = (V_1, V_2, \dots, V_{k-1}) \in \mathcal{P}(V \setminus W)^{k-1}$ such that $|V_i| = t'$ and
$V_1 \times \dots \times V_{k-1}\subset S$.

If we now concatenate $P'$ with $T$ (choosing a subset of $X_i \subset V_i$ of size $t$ for each $i$ if necessary), we get
a $k$-tuple $(X_1, \dots, X_{k-1}, T)$, of $t-sets$ of $V$ % todo k-tuple is split
which by the definition of $S$ satisfies
$X_1 \times \dots \times X_{k-1} \times T \subset E = E(G)$
so it forms a $\compoverset{k}{t}$ in $G$.

\begin{algorithm}[H]
    \caption{Finding a balanced partite $k$-graph in a $k$-graph}
    \label{alg:kpartite}
    \begin{algorithmic}[1]
        \Function{FIND\_PARTITE}{$G, k$}
            \State \textbf{assert} G is a $k$-graph
            \If {$k = 1$} \label{line:base_case}
                \State \Return $(\{x \colon \{x\} \in E(G)\})$
            \EndIf

            \State $V \gets V(G), E \gets E(G), n \gets |V|,\, m \gets |E|,\, d \gets m/n^k$
            \State $t \gets t(n, d, k),\, w \gets w(n, d, k),\, s \gets s(n, d, k)$ \label{line:tws}
            \State \textbf{assert} $t \geq 2$ \label{line:min_t}
            \State $W \gets$ a set of $w$ vertices with highest degree in $G$ \label{line:W}
            \State $U \gets \binom{V\setminus W}{k-1}$

            \ForAll{$T \in \binom{W}{t}$} \label{line:for}
                \State $S \gets \{\,y \in U \colon \{x\} \cup y \in E \text{ for all } x \in T\,\}$ \label{line:S}
                \If{$|S| \geq s$}
                    \State $G' \gets (V \setminus W, S)$ \label{line:rec_call}
                    \State $(V_1, \dots, V_{k-1}) \gets$ \Call{FIND\_PARTITE}{$G', k-1$}
                    \State \Return $(V_1, \dots, V_{k-1}, T)$ \label{line:return}
                \EndIf
            \EndFor
        \EndFunction
    \end{algorithmic}
\end{algorithm}

\subsection{Proof of Correctness} \label{subsec:proof-of-correctness}

The implementation of the algorithm and its proof of correctness are less cumbersome if we assume
a $1$-graph to be just a subset of a set and use it as the base case.
We also make the simplification of not including in Algorithm~\ref{alg:kpartite}
the size reduction of the sets obtained from the recursive call.
The algorithm as stated in fact returns a complete $k$-partite
subgraph with part sizes \emph{at least} $t$, which can easily be post-processed
if desired to get a complete \emph{balanced} subgraph with part sizes $t$.

The aim of the rest of this section is to prove that this algorithm is correct
(as long as the  condition $t \geq 2$ in line~\ref{line:min_t} is met on the first call)
and runs in polynomial time.
That is, to prove it meets the requirements of Theorem~\ref{thm:kpartite}.
From now on, we assume $k \geq 2$ and
$t \geq 2$, unless stated otherwise.
The following observation is useful for some of the bounds we have to prove.

\begin{remark}\label{rm:min_d}
    The requirement $t \geq 2$ is met whenever
    \[
        d \geq 3 \cdot 2^{\frac{k - 1}{2^{k-1}}} n^{-\frac{1}{2^{k-1}}},
    \]
    However, $d$ satisfies
    \[
        d = \frac{m}{n^k} \leq \frac{\binom{n}{k}}{n^k} < \frac{1}{k!},
    \]
    so we get a minimum value of $n$:
    \[
        n > \left( k!\, \cdot 3 \cdot 2^{\frac{k-1}{2^{k-1}}} \right)^{2^{k-1}} \geq 72.
    \]
    This also lets us prove the bound
    \[
        d \geq 3 \sqrt{\frac{2}{n}}
    \]
    for all $k \geq 2$.
    We have already seen that this is the case for $k=2$.
    For $k > 2$, suppose that the bound is not met.
    Then,
    \[
       3 n^{-\frac{1}{4}} \leq 3 n^{-\frac{1}{2^{k-1}}} < d < 3 \sqrt{\frac{2}{n}},
    \]
    which by algebraic manipulation implies $n < 4$.
\end{remark}

We start by proving that the selection of $t, w, s$ in line~\ref{line:tws} of Algorithm~\ref{alg:kpartite}
is sound, in the sense that we only consider subsets of sizes smaller than the corresponding supersets.
% todo a bit clunky

\begin{lemma}\label{lm:sound}
    For $t, w, s$ as selected in line~\ref{line:tws} of Algorithm~\ref{alg:kpartite},
    we have that
    $t  \leq w \leq n$, $k - 1 \leq n - w$ and $s \leq \binom{n - w}{k - 1}$.
    \begin{proof}
        It is clear from the definitions that $w \geq t$.
        To see that $w \leq n$, we in fact show that $w < \frac{n}{2}$.
        If not, then
        \[
            \frac{n}{2} \leq
            w =
            \left\lceil \frac{2t}{d} \right\rceil \leq
            1 + \frac{2t}{d} <
            1 + \frac{2 \log (n/2) \sqrt{n}}{3} = % todo one more step
            1 + \frac{n}{4}.
        \]
        This implies that $n < 4$, in contradiction to Remark~\ref{rm:min_d}.
        It is also clear from Remark~\ref{rm:min_d} that $n > 2k$
        so we also have $k < n/2$.
        Therefore, $ k + w < n/2 + n/2 = n$, which implies $k - 1 < n - w$,
        as we wanted to show.

        Finally, for sake of contradiction,
        suppose $s > \binom{n - w}{k - 1}$.
        By the definition of $s$~\eqref{eq:s}
        and the fact that $\binom{n-w}{k-1}$ is an integer, we have that
        $d^t n^{k-1} > \binom{n - w}{k - 1}$.
        Then, using the fact that $w < \frac{n}{2}$,
        \[
            \left( \frac{n}{2k} \right)^{k-1} \leq
            \left( \frac{n-w}{k-1} \right)^{k-1} \leq
            \binom{n - w}{k - 1} < d^t n^{k-1},
        \]
        which implies
        \[
            \left( \frac{1}{2k} \right)^{k-1} < d^t \leq
            \left( \frac{1}{k!} \right)^2.
        \]
        In the last inequality, we have used that $t \geq 2$ and that $d \leq \frac{1}{k!}$.
        Since $k!^2 \geq (2k)^{k-1}$ for all $k$,
        we have reached a contradiction. \qedhere

    \end{proof}
\end{lemma}

The next step is to show that there are many edges with exactly one vertex in $W$.
More precisely, we have the following.

\begin{lemma}\label{lm:many_edges}
    Given $W  \subset V$ as defined in line~\ref{line:W} of Algorithm~\ref{alg:kpartite},
    There are at least $\frac{3}{2}dwn^{k-1}$ edges of $G$ with exactly one vertex in $W$.
    \begin{proof}
        The degree sum over $V$ is $kdn^{k}$.
        By averaging, the degree sum over $W$ is at least
        $\frac{w}{n}kdn^{k} = wkdn^{k-1}$.
        For $2 \leq j \leq n$,
        consider the contribution to this sum by edges with exactly $j$ vertices in $W$.
        Each such edge contributes $j$ to the sum, and there are at most
        $\binom{w}{j}\binom{n-w}{k-j} \leq
        \frac{w^j n^{k-j}}{j!} \leq
        \frac{w^j n^{k-j}}{j}$ of them.
        Thus, the total contribution of these edges is at most $w^j n^{k-j} \leq w^{2}n^{k-2}$.
        The number of edges with only one vertex in $W$ is then at least

        \[
            wkdn^{k-1} - (k-1)w^{2}n^{k-2} = dwn^{k-1} \left( k - \frac{(k-1)w}{nd}\right).
        \]

        Suppose, by way of contradiction,
        that $ k - \frac{(k-1)w}{nd} < \frac{3}{2}$.
        Using that $\frac{k-1}{k-3/2} \leq 2$
        for $k \geq 2$, we arrive at
        \[
             2 \geq  \frac{nd}{w},
        \]
        which implies
        \[
            d \leq \frac{2w}{n} = \frac{2 \left\lceil\frac{2t}{d} \right\rceil}{n}
            < \frac{6t}{dn},
        \]
        where the last inequality follows from the fact that $t > 1$ and $d \leq 1$.
        Algebraic manipulation then yields
        \[
            nd^2 < 6t.
        \]
        We now closely follow the steps of Mubayi and Turán~\cite{MUBAYI2010174}.

        If $3\sqrt {\frac{2}{n}} \leq d \leq 3 \sqrt{\frac{\log n}{n}}$, we get
        \[
            18 \leq nd^2
            < 6t \leq
            6 \frac{\log (n/2)}{\log(3/d) } <
            6 \frac{\log n}{\log\left(\sqrt{\frac{n}{\log n}}\right)} =
            12 \frac{\log n}{{\log \left( \frac{n}{\log n} \right)}} <
            12 \frac{\log n}{{\log \left( \frac{n}{\log n} \right)}} <
            12 \frac{\log n}{{\log \left( n^{2/3} \right)}} =
            18,
        \]
        which is a contradiction.

        Otherwise, we have $d > 3 \sqrt{\frac{\log n}{n}}$.
        This yields $9 \log n \leq nd^2 < 6t < 6 \log n$,
        again, a contradiction.
    \end{proof}
\end{lemma}

We use this fact to show that for some $T \subset W$,
there is a large number of $(k-1)$-subsets of $V \setminus W$
that form an edge with every vertex in $T$.

\begin{lemma}\label{lm:return}
    For some $T \in \binom{W}{t}$, the corresponding set $S$ defined
    in line~\ref{line:S} of Algorithm~\ref{alg:kpartite} has size at least $s$.
    \begin{proof}
        We apply Theorem~\ref{thm:kst} to the $2$-partite $2$-graph
        \[
            \mathcal{P} = (U, W; F),
        \]
        where $F$ is defined as
        \[
            F = \{(x, y) \in U \times W \mid \{x\} \cup y \in E \}.
        \]
        By Lemma~\ref{lm:many_edges}, $\mathcal{P}$ has at least
        $\frac{3}{2}dwn^{k-1}$ edges.
        By way of contradiction, suppose that the lemma is false.
        There are no sets $S \in \binom{U}{s}, T \in \binom{W}{t}$
        such that $(x, y) \in E (\mathcal{P})$ for all $x \in S, y \in T $.
        In other words, there is no embedding of $K(s, t)$ in $\mathcal{P}$.
        By Theorem~\ref{thm:kst} applied with $u = \binom{n-w}{k-1}$,
        this implies that
        % TODO: check the math works, just copied

        \[
            \frac{3}{2}dwn^{k-1} \leq
            \, z \left(\binom{n - w}{k-1}; w, s, t  \right) \leq
            (s-1)^{1/t}(w-t+1)\binom{n-w}{k-1}^{1-1/t} + (t-1)\binom{n-w}{k-1}.
        \]
        We now substitute into the above expression $(s-1) \leq d^t n^{k-1}$ (which
        follows from $s = \lceil d^t n^{k-1} \rceil$) and $w > 0$:
        \[
             \frac{3}{2}dwn^{k-1} <
             \, dn^{\frac{k-1}{t}} w \binom{n}{k-1}^{1-1/t} + t \binom{n}{k-1} \leq
             dn^{\frac{k-1}{t}} wn^{(k-1)(1-1/t)} + tn^{k-1}.
        \]
        Finally, we substitute $t \leq \frac{1}{2}dw$, which follows from
        $w = \left\lceil \frac{2t}{d} \right\rceil$:
        \[
            \frac{3}{2}dwn^{k-1} <
            dn^{\frac{k-1}{t}} wn^{(k-1)(1-1/t)} + \frac{1}{2} dwn^{k-1} =
            \frac{3}{2} dwn^{k-1},
        \]

        which is a contradiction.
    \end{proof}
\end{lemma}

This shows that we reach the recursive call in line~\ref{line:rec_call} of Algorithm~\ref{alg:kpartite}
at some iteration of the loop in line~\ref{line:for}.
The next step will be to show that this recursive call finds a $k-1$-partite $k-1$-graph in $G'$ of
part sizes at least $t$.
For this, we bound the density $d'$ of $G'$:
\[
    d' \geq \frac{s}{(n-w)^{k-1}} \geq \frac{d^t n^{k-1}}{n^{k-1}} = d^t,
\]
and ensure that the associated part size
\[
    t' = t(n - w, d', k - 1)
\]
satisfies $t' \geq t$.

\begin{lemma}\label{lm:t_prime}
    For all $k \geq 3$, $t' \geq t$.

    \begin{proof}

        Substituting the new parameters into the definition, we get
        \[
            t' = \left\lfloor \left(\frac{\log ((n-w)/2^{k-2})}{\log (3/d')} \right)^
            {\frac{1}{k-2}} \right\rfloor.
        \]

        We start by using that $d' \geq d^t$ and that $w \leq n/2$:

        \[
            t' \geq
            %
            \left\lfloor \left(  \frac{\log ((n-w)/2^{k-2})}{\log (3/d^t)} \right)^
            {\frac{1}{k-2}} \right\rfloor \geq
            %
            \left\lfloor \left(  \frac{\log (n/2^{k-1})}{\log (3/d^t)} \right)^{\frac{1}{k-2}} \right\rfloor =
            %
            \left\lfloor \left(  \frac{\log (n / 2^{k-1})}{\log 3 - t \log d} \right)^
            {\frac{1}{k-2}} \right\rfloor.
        \]
        Then, we substitute the definition of $t$, where removing the floor function
        maintains the inequality because the right hand side is decreasing in $t$ (recall $d \leq 1$):

        \begin{equation} \label{eq:t_prime}
            t' \geq
            %
            \left\lfloor \left(  \frac{\log (n / 2^{k-1})}
            {\log 3 - \left(  \frac{\log (n / 2^{k-1})}{\log (3/d)} \right)^{\frac{1}{k-1}}  \log d} \right)^
            {\frac{1}{k-2}} \right\rfloor
            =
            %
            \left\lfloor \left(  \frac{\log (n / 2^{k-1})^{1-\frac{1}{k-1}}}
            {\frac{\log 3}{\log(n / 2^{k-1})^{\frac{1}{k-1}}} - \frac{\log d}{\log (3/d)^{\frac{1}{k-1}}} }
            \right)^{\frac{1}{k-2}} \right\rfloor.
        \end{equation}

        Now we argue that $n/2^{k-1} \geq 3/d$.
        Otherwise, by Remark~\ref{rm:min_d}, we would have
        \[
            \frac{3}{n^{\frac{1}{2^{k-1}}}} \leq d < \frac{3 \cdot 2^{k-1}}{n},
        \]
        which implies
        \[
            \sqrt{n} < n^{1 - \frac{1}{2^{k-1}}} \leq 2^{k-1} < k!,
        \]
        so that
        \[
            n < k!^2,
        \]
        contradicting the minimum value of $n$ in Remark~\ref{rm:min_d}.

        This allows us to find a common denominator on the
        right side of~\eqref{eq:t_prime}:
        \[
            t' \geq
            \left\lfloor \left(  \frac{\log (n / 2^{k-1})^{1-\frac{1}{k-1}}}
            {\frac{\log 3 - \log d}{\log(3 / d)^{\frac{1}{k-1}}} } \right)^
            {\frac{1}{k-2}} \right\rfloor =
            %
            \left\lfloor \left(  \frac{\log (n / 2^{k-1})^{1-\frac{1}{k-1}}}
            {\frac{\log (3 / d)}{\log(3 / d)^{\frac{1}{k-1}}} } \right)^
            {\frac{1}{k-2}} \right\rfloor =
            %
            \left\lfloor \left(  \frac{\log (n / 2^{k-1})}
            {\log (3 / d)} \right)^
            {\frac{1}{k-1}} \right\rfloor =
            %
            t. \qedhere
        \]
    \end{proof}
\end{lemma}

This means that, assuming that the algorithm finds a $\compoverset{k-1}{t'}$ in $G'$ in the recursive call,
it finds a $\compoverset{k}{t}$ in $G$.
This argument only works if $k \geq 3$.
For $k=2$, the recursive call is handled by the base case in
line~\ref{line:base_case} of Algorithm~\ref{alg:kpartite}.
Therefore, the part size of the (singleton) tuple returned by the recursive call
is the number of (single-vertex) edges in $G'$, which is at least $s$.
To ensure that the algorithm returns a $K(t, t)$ in this case,
it suffices to show the following.

\begin{lemma}\label{lm:base_case}
    For $k=2$, Algorithm~\ref{alg:kpartite} finds $s \geq t$.
    \begin{proof}
        By way of contradiction, suppose that $t > s$.
        Substituting $k=2$ into $s = \lceil d^t n^{k-1} \rceil$, we get
        $t > \left\lceil d^t n \right\rceil$ which implies
        \[
            t >
            d^t n \geq
            d^{\frac{\log n}{\log (3/d)}} n =
            3^{\frac{\log n}{\log (3/d)}}(d/3)^{\frac{\log n}{\log (3/d)}} n \geq
            \frac{3^t}{n} n =
            3^t,
        \]
        which is false for all $t \geq 0$.
    \end{proof}
\end{lemma}

All in all, we can now state our main theorem.

\begin{theorem}
    Algorithm~\ref{alg:kpartite} finds a balanced partite $k$-graph in a $k$-graph $G$ with
    $n$ vertices and $m = d n^k$ with part size $t(n, d, k)$ in polynomial time,
    as long as $t(n, d, k) \geq 2$.
    \begin{proof}
        To prove the correctness of the algorithm, we proceed by induction on $k$.
        If $k=2$, it follows from Lemmas~\ref{lm:return} and~\ref{lm:base_case}.
        Indeed, the algorithm finds $(V_1, T)$ with $|T| = t$ and $|V_1| \geq s \geq t$.
        Furthermore, $V_1$ is the set of vertices $x \in V \setminus W$ such that
        $\{x, y\} = \{x\} \cup \{y\} \in E$ for all $y \in T$.
        This means that $V_1 \times T \subset E(G)$.

        If $k \geq 3$,
        Lemma~\ref{lm:return} tells us that the algorithm
        reaches line~\ref{line:rec_call} at some iteration of the loop.
        Furthermore, Lemma~\ref{lm:t_prime} tells us that the recursive call in line~\ref{line:rec_call}
        has a part size $t' \geq t$.
        In particular, this means that $t' \geq 2$.
        Using the induction hypothesis for $k-1$,
        this recursive call is successful and
        returns a tuple of sets
        $(X_1, X_2, \dots, X_{k-1}) \in \mathcal{P}(V)^{k-1}$ such that $|X_i| \geq t(n-w, d', k-1) \geq t$
        for all $i$ and $X_1 \times \dots \times X_{k-1} \subset E(G')$.
        However, by construction, $G' = L_{k-1}(G; T)$, which means that $T \times E(G') \subset E(G)$.
        All in all, the tuple $(X_1, \dots, X_{k-1}, T)$ returned in line~\ref{line:return}
        satisfies $X_1 \times \dots \times X_{k-1} \times T \subset E = E(G)$, making the algorithm correct.

        For the time complexity, note that all operations in the algorithm are in polynomial time, % TODO: check this
        except for perhaps the for loop in line~\ref{line:for} and the recursive call in line~\ref{line:rec_call}.

        We first argue that the for loop in line~\ref{line:for} runs in polynomial time.
        This is argued in the Mubayi and Turán paper~\cite{MUBAYI2010174},
        but we reproduce the argument here for completeness:
        The $t$-sets of $W$ can be enumerated in
        $O\left( \binom{w}{t} \right)$ steps~\cite{reingold1977combinatorial}.
        However, we can bound
        \[
            \binom{w}{t} \leq
            \binom{2t/d + 1}{t} <
            \left( \frac{3et/d}{t} \right)^{t} =
            \left( \frac{3e}{d} \right)^{t} <
            e^{3 t + t \log (1/d)} <
            e^{4 \log n} = n^4.
        \]

        Because there is only one recursive call, we can prove that it runs in polynomial time
        by induction on $k$.
        Clearly, if the algorithm runs in polynomial time for $k-1$,
        it also runs in polynomial time for $k$.
        We can take as a base case $k=1$, which has no recursive calls so
        it runs in polynomial time.

    \end{proof}
\end{theorem}





