%! Author = Ferran

% Preamble
\documentclass[12pt]{article}

% Packages
\usepackage{amsmath}
\usepackage{parskip}
\usepackage[margin=70pt]{geometry}
\usepackage{amsthm}
\usepackage{mathtools}
\author{Ferran Espuña}
\date{} % clear date


\newtheorem{thm}{Theorem}
\newtheorem{lemma}[thm]{Lemma}



% Document
\begin{document}

    \title{Extending Mubayi and Turán's Algorithm to $3$-graphs}

    \maketitle

    Let $G$ be a $3$-graph with $n$ vertices and $m = \epsilon n^3$ edges.
    A polynomial time algorithm is given to find a $K(q, q, q)$ in $G$ for

    \begin{align*}
        q = \left \lfloor c^{(3)}_{\epsilon} \sqrt {\log n} \right \rfloor
        \label{eq:q}
    \end{align*}

    As long as (insert condition here). % TODO: Insert condition
    
    Note that this result is tight up to the constant $c^{(3)}_{\epsilon}$,
    as proved in~\cite{Erods1964}.
    This result is a generalization of the result in $2$-graphs by~\cite{MUBAYI2010174},
    and algorithm will be analogous to the one given there.
    The procedure is as follows:

    \begin{enumerate}
        \item Choose parameters $q < r < n$ depending on $n$ and $\epsilon$.
        \item Let $R$ be the set of $r$ vertices with the highest degree in $G$.
        \item find a subset $Q \subset R$ with $q$ vertices such that there is a large
        $S \subset \binom{[n] \setminus Q}{2}$ satisfying
        $xyz \in E(G) \, \forall \, \{x, y\} \in S, \, z \in Q$.
        Say, of size s.
        \item Apply the algorithm of~\cite{MUBAYI2010174} to find a $K(q, q)$ in the
        $2$-graph induced by $S$.
        Say, we find partition $S \supset U \cup V$.
    \end{enumerate}

    If successful, a $K(q, q, q)$ has been found in $G$ with parts $U, V, Q$.
    The problem is now to find parameters $q, r$ such that the above procedure is successful
    and the algorithm runs in polynomial time.

    \begin{lemma}\label{many_edges}

        As long as  $r \leq \epsilon n$ ,
        there are at least $\epsilon r n^2$ edges in $G$ with exactly one vertex in $R$.

        \begin{proof}
            The sum of the degrees in $G$ is $3m$.
            Therefore, by the pigeonhole principle,
            \begin{align*} \label{eq:pigeonhole}
                \sum_{v \in R} d(v) \geq r \cdot \frac{3m}{n} = 3 \epsilon r n^2
            \end{align*}
            However, here we are overcounting:
            \begin{itemize}
                \item The edges with only one vertex in $R$ are counted exactly once.
                \item The edges with two vertices in $R$ are counted twice.
                The contribution of these is at most $r(r-1)(n-r) < r^{2}n$
                \item The edges with all vertices in $R$ are counted three times.
                The contribution of these is at most $r(r-1)(r-2) < r^3 < r^{2}n$
            \end{itemize}

            Therefore, the condition will hold as long as
            $r^{2}n \leq \epsilon r n^2 \iff r \leq \epsilon n$.
        \end{proof}
    \end{lemma}

    Next, a counting argument in the style of~\cite{Kovari1954}
    is used to guarantee the existence of $Q$ and $S$.
    The size $q$ of $Q$ will be left as a parameter to be determined later,
    and the size $s$ of $S$ will be determined by the following lemma:

    \begin{lemma}\label{s}
        Under the same assumptions as in Lemma~\ref{many_edges},
        and assuming $r \leq n/2$, $r \geq q / \epsilon$,
        there is a subset $Q \subset R$
        of size $q$  and a subset $S \subset \binom{[n] \setminus Q}{2}$ of size
        \begin{align*}
            s \coloneqq \frac{n^2}{8} \left(\frac{\epsilon}{e}\right)^q % TODO: this can be improved
        \end{align*}
        such that $xyz \in E(G) \, \forall \, \{x, y\} \in S, \, z \in Q$.

        \begin{proof}
            Let $E$ be the set of edges with exactly one vertex in $R$.
            for every $\{x, y\} \in \binom{[n] \setminus R}{2}$, let $E_{xy}$ be the set of
            edges in $E$ containing $x$ and $y$.
            Finally, let
            \begin{align*}
                T = \left\{P \subset E_{xy} : x, y \in \binom{[n] \setminus R}{2} , \, |P| = q\right\}
            \end{align*}

            On the one hand, the number of elements in $T$ is

            \begin{align*}
                \sum_{\{x, y\} \in \binom{[n] \setminus R}{2}} \binom{|E_{xy}|}{q}
                \geq
                \binom{n - r}{2} \binom{\epsilon r n^2 / \binom{n-r}{2}}{q}
                >
                \binom{n - r}{2} \binom{\epsilon r}{q}
                \geq
                \frac{n^2}{8} \binom{\epsilon r}{q}
            \end{align*}

            Where the first inequality follows from the convexity of

            \[
                f(x) =
                \begin{cases}
                   \binom{x}{q} & \text{if } x \geq q - 1 \\
                   0 & \text{otherwise}
                \end{cases}

            \]
            and the third
            from the fact that $r \leq n/2$.

            On the other hand, there are only $\binom{r}{q}$ possible $q-$subsets of $R$.
            By the pigeonhole principle, one of these (say $Q$) must be the set of
            vertices in $R$ associated with $P_j$ for $k$ different $P_j \in T$, where $k$ is

            \begin{align*}
                \frac{|T|}{\binom{r}{q}} > \frac{n^2 \binom{\epsilon r}{q}}{8 \binom{r}{q}} \geq
                \frac{n^2\left( \frac{\epsilon r}{q}\right)^q}{8\left(\frac{e r}{q}\right)^q} =
                \frac{n^2}{8} \left(\frac{\epsilon}{e}\right)^q = s
            \end{align*}

        \end{proof}
    \end{lemma}

    Now, the algorithm of~\cite{MUBAYI2010174} is applied to the graph $G'$ with vertex set $[n]$
    and edge set $S$. % TODO: explicitly state that we are assuming s is large enough, i.e. > n^3/2 --> what does this mean for epsilon?

    This yields a $K(q', q') \subset G'$ with
    \begin{align*}
        q' = \left \lfloor \frac{\ln(n/2)}{\ln(2en^2/s)} \right \rfloor =
        \left \lfloor \frac{\ln(n/2)}{\ln(16e^{q+1} / \epsilon^q)} \right \rfloor
    \end{align*}

    For the found subgraph to be a $K(q, q, q)$, it is necessary that $q' \geq q$.
    A sufficient condition is that

    \begin{align*}
        q \leq \frac{\ln(n/2)}{\ln(16e^{q+1} / \epsilon^q)} - 1 =
        \frac{\ln(n/2)}{\ln(16e) - q  \ln(e / \epsilon)} - 1
    \end{align*}

    This is true for
    \begin{align*}
        0 \leq q \leq
        \frac
        {\ln(16 \epsilon) + \sqrt {(\ln(16 \epsilon))^2 + 4\ln(n/(32e))\ln(e/ \epsilon)}}
        {2\ln(e / \epsilon)}
        % TODO: Check this, just did it off the top of my head
    \end{align*}

    so a valid value for $q$ is

    \begin{align*}
        q =
        %
        \left \lfloor
        \frac{\sqrt {4 \ln(n/(32e))\ln(e/ \epsilon)}}
        {2\ln(e / \epsilon)}
        \right \rfloor =
        %
        \left \lfloor
        \frac{\sqrt {\ln(n/(32e))}}
        {\sqrt {\ln(e / \epsilon)}}
        \right \rfloor \sim
        %
        \frac{\sqrt {\ln n}}{\sqrt {\ln(e / \epsilon)}}, \,
        n \to \infty
    \end{align*}

    This means that, for small $n$, we can just find the biggest $3$-partite
    subgraph in $G$ by hand, and for large $n$, we can use the algorithm
    described with
    \begin{align*}
        q = \left \lfloor c^{(3)}_{\epsilon} \sqrt {\log n} \right \rfloor
    \end{align*}

    and
    \begin{align*}
        c^{(3)}_{\epsilon} = \frac{1}{\sqrt {\ln(2e / \epsilon)}} =
        \frac{1}{\sqrt {\ln(2en^3/m)}}
    \end{align*}

    Finally, to determine the value of $r$ and the running time of the algorithm,
    recall that the only conditions we have imposed on $r$ are
    \begin{align*}
        r & \leq \epsilon n \\
        r & \leq n/2 \\
        r & \geq q / \epsilon
    \end{align*}
    So we can define $r = \left \lceil q / \epsilon \right \rceil$
    as long as $\left \lceil q / \epsilon \right \rceil \leq \min \left\{n/2, \, \epsilon n\right\}$.
    For $\epsilon \geq 1/2$ this clearly holds for $n$ large enough,
    % TODO: what if not? Probably will get some conditions on epsilon, just like in the case r = q







    \bibliography{../main}
    \bibliographystyle{plain}

\end{document}
